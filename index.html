<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wplace 실시간 국내 주요 지점 감시기</title>
  <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
  <link rel="manifest" href="images/site.webmanifest">
  <style>
    :root{ --frame-bg: #e6e5e5; --gap: 18px; --accent: #0055ff; }
    html,body{
      height:100%;
      margin:0;
      font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;
      background:#f8f9fa;
      color:#111
    }
    .wrap{max-width:1200px;margin:28px auto;padding:20px}
    header{text-align:center;margin-bottom:24px}
    header h1{font-size:26px;margin:0;color:var(--accent)}
    header p{font-size:15px;color:#444;margin:6px 0 0}
    .controls{margin:20px 0;text-align:center}
    .controls label{font-size:14px;margin-right:8px}
    .controls input{width:70px;padding:4px;font-size:14px;text-align:center;border:1px solid #ccc;border-radius:6px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:var(--gap)}
    .card{background:#fff;border-radius:12px;padding:14px;display:flex;flex-direction:column;align-items:center;
      box-shadow:0 6px 18px rgba(0,0,0,0.08);transition:transform 0.2s ease, box-shadow 0.2s ease}
    .card:hover{transform:translateY(-4px);box-shadow:0 10px 22px rgba(0,0,0,0.12)}
    
    .card-header {
      position: relative;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .card .meta{width:100%;display:flex;justify-content:center;align-items:center;margin-bottom:10px}
    .card .meta strong{font-size:16px;color:#222}
    
    .goto-btn {
      position: absolute;
      top: 1px;
      right: 2px;
      background: linear-gradient(135deg, #0055ff, #0099ff);
      color: white;
      border: none;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 3px;
      text-decoration: none;
      box-shadow: 0 2px 6px rgba(0, 85, 255, 0.3);
      transition: all 0.2s ease;
    }

    .goto-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 85, 255, 0.4);
    }

    .goto-btn svg {
      width: 12px;
      height: 12px;
    }
    
    .frame{width:100%;height:420px;border-radius:8px;overflow:hidden;position:relative;background:var(--frame-bg)}
    .frame img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:contain;transition:opacity 0.3s ease}
    .frame img.hidden{opacity:0}

    /* 서울 태극기 */
    .frame#frame-1 img { transform: scale(3.2) translateY(-30%); }
    /* 독도 태극기 */
    .frame#frame-2 img { transform: scale(2.5) translate(18% ,30%); }
    /* 거쿠 */
    .frame#frame-3 img { transform: scale(1.36) translate(-10%, -13%); }
    /* 통깡이 */
    .frame#frame-4 img { transform: scale(2.2) translate(-22%, 5%); }

    @media (max-width:520px){.frame{height:300px}}

    /* 섹션 공통 스타일 */
    .featured {margin-top:40px;}
    .featured h1 {font-size:26px; color:var(--accent); text-align:center; margin-bottom:10px;}
    .featured p.notice {font-size:12px; color:#666; text-align:center; margin:0 0 20px;}

    /* 타일 그리드 스타일 */
    .tile-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0;
      max-width: 600px;
      margin: 0 auto;
    }
    .tile-row {
      display: flex;
      gap: 0;
    }
    .tile-row img {
      width: 200px;
      height: 200px;
      object-fit: cover;
      display: block;
      transition: opacity 0.3s ease;
    }
    .tile-row img.hidden {
      opacity: 0;
    }
    @media (max-width: 650px) {
      .tile-row img {
        width: 120px;
        height: 120px;
      }
    }

    /* 접속자 카운터 */
    .visitor-counter {
      margin-top: 30px;
      text-align: center;
      font-size: 14px;
      color: #666;
      padding: 12px 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 300px;
      margin-left: auto;
      margin-right: auto;
    }

    .visitor-counter .count {
      font-size: 18px;
      font-weight: bold;
      color: var(--accent);
      margin: 0 4px;
    }

    /* 하단 제작자 */
    footer {
      margin-top: 40px;
      text-align: center;
      font-size: 14px;
      color: #444;
      padding-bottom: 60px;
    }
    footer a {
      color: var(--accent);
      text-decoration: none;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Wplace 실시간 국내 주요 지점 감시기</h1>
      <p>각 사진은 설정한 시간마다 자동으로 새로고침 됩니다. (기본값 30초)</p>
    </header>

    <div class="controls">
      <label for="interval">새로고침 간격(초):</label>
      <input type="number" id="interval" value="30" min="1" />
    </div>

    <!-- 주요 지점 -->
    <main class="grid">
      <article class="card" id="card-1">
        <div class="card-header">
          <div class="meta">
            <strong>서울 태극기</strong>
          </div>
          <a href="https://wplace.live/?lat=37.475207106049986&lng=127.00274380927735&zoom=12.997432909015853" target="_blank" class="goto-btn">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
            바로가기
          </a>
        </div>
        <div class="frame" id="frame-1">
          <img id="img-1" data-src="https://backend.wplace.live/files/s0/tiles/1746/793.png" alt="서울 태극기" />
        </div>
      </article>

      <article class="card" id="card-2">
        <div class="card-header">
          <div class="meta">
            <strong>독도 태극기</strong>
          </div>
          <a href="https://wplace.live/?lat=37.268457763793734&lng=131.87452115302733&zoom=12.708937213958524" target="_blank" class="goto-btn">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
            </svg>
            바로가기
          </a>
        </div>
        <div class="frame" id="frame-2">
          <img id="img-2" data-src="https://backend.wplace.live/files/s0/tiles/1774/795.png" alt="독도 태극기" />
        </div>
      </article>
    </main>

    <!-- 태극기 주변 -->
    <section class="featured">
      <h1>태극기 주변</h1>
      <p class="notice">※ 태극기 주변 이미지는 자동으로 새로고침되지 않습니다. 잦은 새로고침은 제한이 걸릴 수 있으니 주의해 주세요.</p>
      <div class="card" style="padding:20px; max-width:640px; margin:0 auto; text-align:center;">
        <div class="meta">
          <strong>서울 태극기 주변</strong>
        </div>
        <div class="tile-grid">
          <!-- 첫 번째 줄 -->
          <div class="tile-row">
            <img id="tile-1" data-src="https://backend.wplace.live/files/s0/tiles/1745/792.png" alt="타일 1-1" />
            <img id="tile-2" data-src="https://backend.wplace.live/files/s0/tiles/1746/792.png" alt="타일 1-2" />
            <img id="tile-3" data-src="https://backend.wplace.live/files/s0/tiles/1747/792.png" alt="타일 1-3" />
          </div>
          <!-- 두 번째 줄 -->
          <div class="tile-row">
            <img id="tile-4" data-src="https://backend.wplace.live/files/s0/tiles/1745/793.png" alt="타일 2-1" />
            <img id="tile-5" data-src="https://backend.wplace.live/files/s0/tiles/1746/793.png" alt="타일 2-2" />
            <img id="tile-6" data-src="https://backend.wplace.live/files/s0/tiles/1747/793.png" alt="타일 2-3" />
          </div>
          <!-- 세 번째 줄 -->
          <div class="tile-row">
            <img id="tile-7" data-src="https://backend.wplace.live/files/s0/tiles/1745/794.png" alt="타일 3-1" />
            <img id="tile-8" data-src="https://backend.wplace.live/files/s0/tiles/1746/794.png" alt="타일 3-2" />
            <img id="tile-9" data-src="https://backend.wplace.live/files/s0/tiles/1747/794.png" alt="타일 3-3" />
          </div>
        </div>
      </div>
    </section>

    <!-- 주요 작품 -->
    <section class="featured">
      <h1>주요 작품 (NSFW)</h1>
      <div class="grid">
        <article class="card" id="card-3">
          <div class="meta">
            <strong>거쿠</strong>
          </div>
          <div class="frame" id="frame-3">
            <img id="img-3" data-src="https://backend.wplace.live/files/s0/tiles/1744/800.png" alt="거쿠" />
          </div>
        </article>
        <article class="card" id="card-4">
          <div class="meta">
            <strong>통깡이</strong>
          </div>
          <div class="frame" id="frame-4">
            <img id="img-4" data-src="https://backend.wplace.live/files/s0/tiles/1748/795.png" alt="통깡이" />
          </div>
        </article>
      </div>
    </section>
  </div>

  <!-- 접속자 카운터 -->
  <div class="visitor-counter">
    <span>총 방문자 수: </span>
    <span class="count" id="visitor-count">0</span>
    <span>명</span>
    <br>
    <small style="color: #999; font-size: 12px;">※ 브라우저 세션 기준</small>
  </div>

  <footer>
    만든 놈 - <a href="discord://-/users/1143199445035536404">OrangeBlue</a>
  </footer>

  <script>
    let intervalSec = 30;
    let timer;

    // 자동 새로고침 대상 (타일 제외)
    const imgs = [
      document.getElementById('img-1'),
      document.getElementById('img-2'),
      document.getElementById('img-3'),
      document.getElementById('img-4')
    ];

    // 페이지 최초 로드용 (타일 포함)
    const allImgs = [
      ...imgs,
      ...Array.from({length:9}, (_,i)=>document.getElementById(`tile-${i+1}`))
    ];

    function refreshImages(list){
      list.forEach(img => {
        const base = img.getAttribute('data-src');
        if(!base) return;
        const url = base + (base.includes('?') ? '&' : '?') + 't=' + Date.now();

        const preload = new Image();
        preload.onload = () => {
          img.classList.add('hidden');
          setTimeout(() => {
            img.src = url;
            img.classList.remove('hidden');
          }, 200);
        };
        preload.onerror = () => {
          console.warn('Failed to load image:', url);
        };
        preload.src = url;
      });
    }

    function refreshAll(){
      refreshImages(imgs); // 자동 새로고침 대상만
    }

    function startInterval(){
      clearInterval(timer);
      timer = setInterval(refreshAll, intervalSec * 1000);
    }

    document.getElementById('interval').addEventListener('change', e => {
      intervalSec = parseInt(e.target.value, 10) || 5;
      startInterval();
    });

    // 페이지 로드 시 실행
    refreshImages(allImgs);
    startInterval();

    window.addEventListener('beforeunload', () => clearInterval(timer));
  </script>
</body>
</html>
